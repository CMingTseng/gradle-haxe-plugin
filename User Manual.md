Gradle Haxe Plugin Manual
=========================

## Basics

### Workflow

The Haxe plugin consists of three parts:

* the `CompileHaxe` task that compiles your Haxe code
* the `MUnit` task that runs tests based on a compile task
* publishing artifacts

### The `.har` archive

Each compile task builds an artifact for one specific platform in the form of a HAR archive. This means if you want to build a project for JS and AS3 as well, you will end up with two archives.

The `.har` archive includes everything needed to build your project:

	+- META-INF
	|   +- MANIFEST.MF  -- descriptor for the archive
	+- sources          -- all source files copied into one folder
	+- resources        -- all resources copied into one folder

## Compilation -- the `CompileHaxe` task

You have a project with the following source folders for separate platforms:

	/src/common  -- shared code for all platforms
	/src/js      -- JS-specific code (i.e. for Node.JS and browser)
	/src/node    -- code used only from Node.JS
	/src/browser -- code when used from a web browser
	/src/as      -- ActionScript-specific stuff

You can set up three builds for Node, web browser and AS as such:

	task compileBrowser(type: CompileHaxe) {
		targetPlatform "js"
		classifier "browser"
		configuration configurations.browser
		source "src/common"
		source "src/js"
		source "src/browser"
	}

	task compileNode(type: CompileHaxe) {
		targetPlatform "js"
		classifier "node"
		configuration configurations.node
		source "src/common"
		source "src/js"
		source "src/node"
	}

	task compileAS(type: CompileHaxe) {
		targetPlatform "swf"
		classifier "as"
		configuration configurations.as
		source "src/common"
		source "src/as"
	}

This will give you three `.har` archives, each containing sources from their respective source folders:

* `project-browser.har` -- `src/common`, `src/js`, `src/browser`
* `project-node.har` -- `src/common`, `src/js`, `src/node`
* `project-as.har` -- `src/common`, `src/as`

### Resources

TBD

### The `build` task

A task called `build` is automatically generated by the Haxe plugin that automatically depends on all `CompileHaxe` tasks. So in order to build everything in your project, you can simply issue

	gradle build

## Testing -- the `MUnit` task

If you want to test your code with MUnit, you will need to define some test tasks. Keeping with the example above, here's how you could test the browser artifact:

	task munitBrowser(type: MUnit) {
		test compileBrowser
		testSource "test/common"
		testSource "test/some-tests-for-browser-only"
	}

You can then run the tests via

	gradle munitBrowser



### The `test` tasks

Similar to the auto-generated `build` task, the Haxe plugin also creates a catch-all task for all tasks of type `MUnit` called `test`. So to run all MUnit tests on your project you can go:

	gradle test
